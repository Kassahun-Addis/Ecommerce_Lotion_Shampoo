{"ast":null,"code":"imp;\nimport fs from \"fs\";\nimport slugify from \"slugify\";\nimport dotenv from \"dotenv\";\ndotenv.config();\n// Configure multer storage\n\nexport const createPostController = async (req, res) => {\n  try {\n    const {\n      title,\n      summary,\n      content\n    } = req.fields;\n    const {\n      photo\n    } = req.files;\n    // Validation\n    switch (true) {\n      case !title:\n        return res.status(500).send({\n          error: \"Title is required\"\n        });\n      case !summary:\n        return res.status(500).send({\n          error: \"Summary is required\"\n        });\n      case !content:\n        return res.status(500).send({\n          error: \"Content is required\"\n        });\n      case photo && photo.size > 1000000:\n        return res.status(500).send({\n          error: \"Photo is required and should be less than 1MB\"\n        });\n    }\n    const posts = new Post({\n      ...req.fields,\n      slug: slugify(title)\n    });\n    if (photo) {\n      posts.photo.data = fs.readFileSync(photo.path);\n      posts.photo.contentType = photo.type;\n    }\n    await posts.save();\n    res.status(201).send({\n      success: true,\n      message: \"Post Created Successfully\",\n      posts\n    });\n  } catch (error) {\n    console.log(error);\n    res.status(500).send({\n      success: false,\n      error,\n      message: \"Error in creating product\"\n    });\n  }\n};\nexport const getPostsController = async (req, res) => {\n  try {\n    const posts = await Post.find({}).select(\"-photo\").limit(12).sort({\n      createdAt: -1\n    });\n    res.status(200).send({\n      success: true,\n      countTotal: posts.length,\n      message: \"All Posts\",\n      posts\n    });\n  } catch (error) {\n    console.log(error);\n    res.status(500).send({\n      success: false,\n      message: \"Error in getting products\",\n      error: error.message\n    });\n  }\n};\nexport const getPostByIdController = async (req, res) => {\n  try {\n    const post = await Post.findOne({\n      slug: req.params.slug\n    }).select(\"-photo\");\n    res.status(200).send({\n      success: true,\n      message: \"Single Post Fetched\",\n      post\n    });\n  } catch (error) {\n    console.log(error);\n    res.status(500).send({\n      success: false,\n      message: \"Error while getting single post\",\n      error\n    });\n  }\n};\nexport const postPhotoController = async (req, res) => {\n  try {\n    const post = await Post.findById(req.params.pid).select(\"photo\");\n    if (post.photo.data) {\n      res.set(\"Content-type\", post.photo.contentType);\n      return res.status(200).send(post.photo.data);\n    }\n  } catch (error) {\n    console.log(error);\n    res.status(500).send({\n      success: false,\n      message: \"Error while getting photo\",\n      error\n    });\n  }\n};\nexport const deletePostController = async (req, res) => {\n  try {\n    await Post.findByIdAndDelete(req.params.pid).select(\"-photo\");\n    res.status(200).send({\n      success: true,\n      message: \"Post deleted successfully\"\n    });\n  } catch (error) {\n    console.log(error);\n    res.status(500).send({\n      success: false,\n      message: \"Error while deleting post\",\n      error\n    });\n  }\n};\nexport const updatePostController = async (req, res) => {\n  try {\n    const {\n      title,\n      summary,\n      content,\n      pid\n    } = req.fields;\n    const {\n      photo\n    } = req.files;\n    // Validation\n    switch (true) {\n      case !title:\n        return res.status(500).send({\n          error: \"Title is required\"\n        });\n      case !summary:\n        return res.status(500).send({\n          error: \"Summary is required\"\n        });\n      case !content:\n        return res.status(500).send({\n          error: \"Content is required\"\n        });\n      case !pid:\n        return res.status(500).send({\n          error: \"pid is required\"\n        });\n      case photo && photo.size > 1000000:\n        return res.status(500).send({\n          error: \"Photo is required and should be less than 1MB\"\n        });\n    }\n    const post = await Post.findByIdAndUpdate(req.params.pid, {\n      ...req.fields,\n      slug: slugify(title)\n    }, {\n      new: true\n    });\n    if (photo) {\n      post.photo.data = fs.readFileSync(photo.path);\n      post.photo.contentType = photo.type;\n    }\n    await post.save();\n    res.status(201).send({\n      success: true,\n      message: \"PostUpdated Successfully\",\n      post\n    });\n  } catch (error) {\n    console.log(error);\n    res.status(500).send({\n      success: false,\n      error,\n      message: \"Error in updating post\"\n    });\n  }\n};\nexport default createPostController;","map":{"version":3,"names":["imp","fs","slugify","dotenv","config","createPostController","req","res","title","summary","content","fields","photo","files","status","send","error","size","posts","Post","slug","data","readFileSync","path","contentType","type","save","success","message","console","log","getPostsController","find","select","limit","sort","createdAt","countTotal","length","getPostByIdController","post","findOne","params","postPhotoController","findById","pid","set","deletePostController","findByIdAndDelete","updatePostController","findByIdAndUpdate","new"],"sources":["C:/Users/HP/Desktop/online store website/Skinecare-Makeup/client/src/pages/Admin/CreatePost.js"],"sourcesContent":["imp\r\nimport fs from \"fs\";\r\nimport slugify from \"slugify\";\r\nimport dotenv from \"dotenv\";\r\ndotenv.config();\r\n// Configure multer storage\r\n\r\nexport const createPostController = async (req, res) => {\r\n  try {\r\n    const { title, summary, content } = req.fields;\r\n    const { photo } = req.files;\r\n    // Validation\r\n    switch (true) {\r\n      case !title:\r\n        return res.status(500).send({ error: \"Title is required\" });\r\n      case !summary:\r\n        return res.status(500).send({ error: \"Summary is required\" });\r\n      case !content:\r\n        return res.status(500).send({ error: \"Content is required\" });\r\n      case photo && photo.size > 1000000:\r\n        return res\r\n          .status(500)\r\n          .send({ error: \"Photo is required and should be less than 1MB\" });\r\n    }\r\n    const posts = new Post({ ...req.fields, slug: slugify(title) });\r\n    if (photo) {\r\n      posts.photo.data = fs.readFileSync(photo.path);\r\n      posts.photo.contentType = photo.type;\r\n    }\r\n    await posts.save();\r\n    res.status(201).send({\r\n      success: true,\r\n      message: \"Post Created Successfully\",\r\n      posts,\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    res.status(500).send({\r\n      success: false,\r\n      error,\r\n      message: \"Error in creating product\",\r\n    });\r\n  }\r\n};\r\n\r\nexport const getPostsController = async (req, res) => {\r\n  try {\r\n    const posts = await Post.find({})\r\n      .select(\"-photo\")\r\n      .limit(12)\r\n      .sort({ createdAt: -1 });\r\n    res.status(200).send({\r\n      success: true,\r\n      countTotal: posts.length,\r\n      message: \"All Posts\",\r\n      posts,\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    res.status(500).send({\r\n      success: false,\r\n      message: \"Error in getting products\",\r\n      error: error.message,\r\n    });\r\n  }\r\n};\r\n\r\nexport const getPostByIdController = async (req, res) => {\r\n  try {\r\n    const post = await Post.findOne({ slug: req.params.slug }).select(\"-photo\");\r\n    res.status(200).send({\r\n      success: true,\r\n      message: \"Single Post Fetched\",\r\n      post,\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    res.status(500).send({\r\n      success: false,\r\n      message: \"Error while getting single post\",\r\n      error,\r\n    });\r\n  }\r\n};\r\n\r\nexport const postPhotoController = async (req, res) => {\r\n  try {\r\n    const post = await Post.findById(req.params.pid).select(\"photo\");\r\n    if (post.photo.data) {\r\n      res.set(\"Content-type\", post.photo.contentType);\r\n      return res.status(200).send(post.photo.data);\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n    res.status(500).send({\r\n      success: false,\r\n      message: \"Error while getting photo\",\r\n      error,\r\n    });\r\n  }\r\n};\r\n\r\nexport const deletePostController = async (req, res) => {\r\n  try {\r\n    await Post.findByIdAndDelete(req.params.pid).select(\"-photo\");\r\n    res.status(200).send({\r\n      success: true,\r\n      message: \"Post deleted successfully\",\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    res.status(500).send({\r\n      success: false,\r\n      message: \"Error while deleting post\",\r\n      error,\r\n    });\r\n  }\r\n};\r\n\r\nexport const updatePostController = async (req, res) => {\r\n  try {\r\n    const { title, summary, content, pid } = req.fields;\r\n    const { photo } = req.files;\r\n    // Validation\r\n    switch (true) {\r\n      case !title:\r\n        return res.status(500).send({ error: \"Title is required\" });\r\n      case !summary:\r\n        return res.status(500).send({ error: \"Summary is required\" });\r\n      case !content:\r\n        return res.status(500).send({ error: \"Content is required\" });\r\n      case !pid:\r\n        return res.status(500).send({ error: \"pid is required\" });\r\n      case photo && photo.size > 1000000:\r\n        return res\r\n          .status(500)\r\n          .send({ error: \"Photo is required and should be less than 1MB\" });\r\n    }\r\n\r\n    const post = await Post.findByIdAndUpdate(\r\n      req.params.pid,\r\n      { ...req.fields, slug: slugify(title) },\r\n      { new: true }\r\n    );\r\n    if (photo) {\r\n      post.photo.data = fs.readFileSync(photo.path);\r\n      post.photo.contentType = photo.type;\r\n    }\r\n    await post.save();\r\n    res.status(201).send({\r\n      success: true,\r\n      message: \"PostUpdated Successfully\",\r\n      post,\r\n    });\r\n  } catch (error) {\r\n    console.log(error);\r\n    res.status(500).send({\r\n      success: false,\r\n      error,\r\n      message: \"Error in updating post\",\r\n    });\r\n  }\r\n};\r\nexport default createPostController"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}